{% extends "base.html" %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <!-- Header -->
            <div class="text-center mb-5">
                <h1 class="section-title">Add New Car</h1>
                <p class="text-muted fs-5">List your vehicle for rental and start earning</p>
            </div>

            <!-- Progress Steps -->
            <div class="row mb-5">
                <div class="col-12">
                    <div class="add-car-progress">
                        <div class="progress-step active" data-step="1">
                            <div class="step-number">1</div>
                            <div class="step-label">Basic Info</div>
                        </div>
                        <div class="progress-step" data-step="2">
                            <div class="step-number">2</div>
                            <div class="step-label">Specifications</div>
                        </div>
                        <div class="progress-step" data-step="3">
                            <div class="step-number">3</div>
                            <div class="step-label">Location & Image</div>
                        </div>
                        <div class="progress-step" data-step="4">
                            <div class="step-number">4</div>
                            <div class="step-label">Review</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-card">
                <form method="POST" action="{{ url_for('add_car') }}" enctype="multipart/form-data" id="addCarForm">
                    
                    <!-- Step 1: Basic Information -->
                    <div class="form-step active" id="step1">
                        <h4 class="fw-bold mb-4 text-primary">
                            <i class="fas fa-info-circle me-2"></i>Basic Information
                        </h4>
                        
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label for="brand" class="form-label fw-semibold">
                                    <i class="fas fa-tag me-2 text-primary"></i>Brand *
                                </label>
                                <select class="form-select form-select-lg border-2" id="brand" name="brand" required 
                                        onchange="validateBrand()">
                                    <option value="">Select brand...</option>
                                    <option value="Toyota">Toyota</option>
                                    <option value="Honda">Honda</option>
                                    <option value="Ford">Ford</option>
									<option value="TATA">TATA</option>
                                    <option value="BMW">BMW</option>
									<option value="Thar">Thar</option>
									<option value="Defender">Defender</option>
                                    <option value="Mercedes">Mercedes</option>
                                    <option value="Audi">Audi</option>
                                    <option value="Tesla">Tesla</option>
                                    <option value="Hyundai">Hyundai</option>
                                    <option value="Kia">Kia</option>
                                    <option value="Nissan">Nissan</option>
                                    <option value="Other">Other</option>
                                </select>
                                <div class="form-text">Select the vehicle manufacturer</div>
                            </div>
                            <div class="col-md-6">
                                <label for="model" class="form-label fw-semibold">
                                    <i class="fas fa-car me-2 text-primary"></i>Model *
                                </label>
                                <input type="text" class="form-control form-control-lg border-2" id="model" name="model" 
                                       placeholder="e.g., Camry, Model 3, X5" required 
                                       oninput="validateModel()"
                                       style="background: #f8f9fa; border-radius: 10px;">
                                <div class="form-text">Enter the specific model name</div>
                            </div>
                        </div>

                        <div class="row mb-4">
                            <div class="col-md-4">
                                <label for="year" class="form-label fw-semibold">
                                    <i class="fas fa-calendar me-2 text-primary"></i>Year *
                                </label>
                                <select class="form-select form-select-lg border-2" id="year" name="year" required 
                                        onchange="validateYear()">
                                    <option value="">Select year...</option>
                                    {% for year in range(2024, 1999, -1) %}
                                    <option value="{{ year }}">{{ year }}</option>
                                    {% endfor %}
                                </select>
                                <div class="form-text">Vehicle manufacturing year</div>
                            </div>
                            <div class="col-md-4">
                                <label for="price_per_day" class="form-label fw-semibold">
                                    <i class="fas fa-dollar-sign me-2 text-primary"></i>Price per Day ($) *
                                </label>
                                <div class="input-group">
                                    <span class="input-group-text bg-light border-end-0">$</span>
                                    <input type="number" class="form-control form-control-lg border-start-0" 
                                           id="price_per_day" name="price_per_day" 
                                           min="1" step="0.01" placeholder="50.00" required 
                                           oninput="validatePrice()"
                                           style="border-radius: 0 10px 10px 0;">
                                </div>
                                <div class="form-text">Recommended: $30-$200 per day</div>
                            </div>
                            <div class="col-md-4">
                                <label for="seats" class="form-label fw-semibold">
                                    <i class="fas fa-users me-2 text-primary"></i>Seats *
                                </label>
                                <select class="form-select form-select-lg border-2" id="seats" name="seats" required 
                                        onchange="validateSeats()">
                                    <option value="">Select seats...</option>
                                    {% for seats in range(2, 9) %}
                                    <option value="{{ seats }}">{{ seats }} seats</option>
                                    {% endfor %}
                                </select>
                                <div class="form-text">Number of passenger seats</div>
                            </div>
                        </div>

                        <div class="text-end">
                            <button type="button" class="btn btn-primary btn-lg px-5" onclick="nextStep(2)">
                                Next <i class="fas fa-arrow-right ms-2"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Specifications -->
                    <div class="form-step" id="step2">
                        <h4 class="fw-bold mb-4 text-primary">
                            <i class="fas fa-cogs me-2"></i>Specifications
                        </h4>

                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label for="transmission" class="form-label fw-semibold">
                                    <i class="fas fa-cog me-2 text-primary"></i>Transmission *
                                </label>
                                <select class="form-select form-select-lg border-2" id="transmission" name="transmission" required 
                                        onchange="validateTransmission()">
                                    <option value="">Select transmission...</option>
                                    <option value="Automatic">Automatic</option>
                                    <option value="Manual">Manual</option>
                                    <option value="Semi-Automatic">Semi-Automatic</option>
                                    <option value="CVT">CVT (Continuously Variable)</option>
                                </select>
                                <div class="form-text">Type of transmission system</div>
                            </div>
                            <div class="col-md-6">
                                <label for="fuel_type" class="form-label fw-semibold">
                                    <i class="fas fa-gas-pump me-2 text-primary"></i>Fuel Type *
                                </label>
                                <select class="form-select form-select-lg border-2" id="fuel_type" name="fuel_type" required 
                                        onchange="validateFuelType()">
                                    <option value="">Select fuel type...</option>
                                    <option value="Petrol">Petrol</option>
                                    <option value="Diesel">Diesel</option>
                                    <option value="Electric">Electric</option>
                                    <option value="Hybrid">Hybrid (Petrol/Electric)</option>
                                    <option value="Plug-in Hybrid">Plug-in Hybrid</option>
                                    <option value="CNG">CNG (Compressed Natural Gas)</option>
                                </select>
                                <div class="form-text">Vehicle fuel or power source</div>
                            </div>
                        </div>

                        <!-- Additional Features -->
                        <div class="mb-4">
                            <label class="form-label fw-semibold">
                                <i class="fas fa-star me-2 text-primary"></i>Additional Features
                            </label>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="feature_ac" name="features" value="ac">
                                        <label class="form-check-label" for="feature_ac">
                                            <i class="fas fa-snowflake me-2 text-info"></i>Air Conditioning
                                        </label>
                                    </div>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="feature_gps" name="features" value="gps">
                                        <label class="form-check-label" for="feature_gps">
                                            <i class="fas fa-map-marker-alt me-2 text-success"></i>GPS Navigation
                                        </label>
                                    </div>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="feature_bluetooth" name="features" value="bluetooth">
                                        <label class="form-check-label" for="feature_bluetooth">
                                            <i class="fas fa-bluetooth me-2 text-primary"></i>Bluetooth
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="feature_camera" name="features" value="camera">
                                        <label class="form-check-label" for="feature_camera">
                                            <i class="fas fa-camera me-2 text-warning"></i>Backup Camera
                                        </label>
                                    </div>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="feature_sunroof" name="features" value="sunroof">
                                        <label class="form-check-label" for="feature_sunroof">
                                            <i class="fas fa-sun me-2 text-warning"></i>Sunroof/Moonroof
                                        </label>
                                    </div>
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="feature_leather" name="features" value="leather">
                                        <label class="form-check-label" for="feature_leather">
                                            <i class="fas fa-chair me-2 text-secondary"></i>Leather Seats
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Vehicle Condition -->
                        <div class="mb-4">
                            <label for="condition" class="form-label fw-semibold">
                                <i class="fas fa-clipboard-check me-2 text-primary"></i>Vehicle Condition
                            </label>
                            <select class="form-select form-select-lg border-2" id="condition" name="condition" 
                                    onchange="validateCondition()">
                                <option value="excellent">Excellent - Like new</option>
                                <option value="very_good" selected>Very Good - Minor wear</option>
                                <option value="good">Good - Normal wear</option>
                                <option value="fair">Fair - Some signs of age</option>
                            </select>
                            <div class="form-text">Overall condition of the vehicle</div>
                        </div>

                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-outline-primary btn-lg px-5" onclick="prevStep(1)">
                                <i class="fas fa-arrow-left me-2"></i>Back
                            </button>
                            <button type="button" class="btn btn-primary btn-lg px-5" onclick="nextStep(3)">
                                Next <i class="fas fa-arrow-right ms-2"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Location & Image -->
                    <div class="form-step" id="step3">
                        <h4 class="fw-bold mb-4 text-primary">
                            <i class="fas fa-map-marker-alt me-2"></i>Location & Image
                        </h4>

                        <div class="mb-4">
                            <label for="location" class="form-label fw-semibold">
                                <i class="fas fa-location-dot me-2 text-primary"></i>Location *
                            </label>
                            <input type="text" class="form-control form-control-lg border-2" id="location" name="location" 
                                   placeholder="Enter full address where car is located" required 
                                   oninput="validateLocation()"
                                   style="background: #f8f9fa; border-radius: 10px;">
                            <div class="form-text">This address will be used for pickup/dropoff</div>
                            
                            <!-- Quick Location Buttons -->
                            <div class="mt-3">
                                <small class="text-muted me-3">Quick locations:</small>
                                <button type="button" class="btn btn-sm btn-outline-secondary me-2" 
                                        onclick="setQuickLocation('Downtown Area')">Downtown</button>
                                <button type="button" class="btn btn-sm btn-outline-secondary me-2" 
                                        onclick="setQuickLocation('Airport Zone')">Airport</button>
                                <button type="button" class="btn btn-sm btn-outline-secondary" 
                                        onclick="setQuickLocation('City Center')">City Center</button>
                            </div>
                        </div>

                        <!-- Image Upload -->
                        <div class="mb-4">
                            <label for="image" class="form-label fw-semibold">
                                <i class="fas fa-camera me-2 text-primary"></i>Car Photos
                            </label>
                            
                            <!-- Image Upload Area -->
                            <div class="image-upload-area border-2 rounded-3 p-4 text-center mb-3" 
                                 style="background: #f8f9fa; border-style: dashed; border-color: #dee2e6;"
                                 onclick="document.getElementById('image').click()">
                                <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                                <h5 class="text-muted">Click to upload car photos</h5>
                                <p class="text-muted small mb-0">JPEG, PNG, or WebP (Max 5MB each)</p>
                                <p class="text-muted small">Recommended: 4-6 photos showing exterior and interior</p>
                            </div>
                            
                            <input type="file" class="form-control d-none" id="image" name="image" 
                                   accept="image/*" multiple onchange="previewImages(this.files)">
                            
                            <!-- Image Preview -->
                            <div class="image-preview-container row g-2 mt-3" id="imagePreview"></div>
                            
                            <div class="form-text">
                                <i class="fas fa-info-circle me-1"></i>
                                Good photos increase booking chances by 70%
                            </div>
                        </div>

                        <!-- Availability -->
                        <div class="mb-4">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="available" name="available" checked 
                                       style="transform: scale(1.3);">
                                <label class="form-check-label fw-semibold" for="available">
                                    <i class="fas fa-check-circle me-2 text-success"></i>
                                    Make car available for rental immediately
                                </label>
                            </div>
                        </div>

                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-outline-primary btn-lg px-5" onclick="prevStep(2)">
                                <i class="fas fa-arrow-left me-2"></i>Back
                            </button>
                            <button type="button" class="btn btn-primary btn-lg px-5" onclick="nextStep(4)">
                                Next <i class="fas fa-arrow-right ms-2"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 4: Review & Submit -->
                    <div class="form-step" id="step4">
                        <h4 class="fw-bold mb-4 text-primary">
                            <i class="fas fa-clipboard-check me-2"></i>Review & Submit
                        </h4>

                        <!-- Car Summary -->
                        <div class="card bg-light border-0 mb-4">
                            <div class="card-body">
                                <h5 class="card-title mb-4">
                                    <i class="fas fa-car me-2"></i>Car Summary
                                </h5>
                                
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <strong>Vehicle:</strong>
                                            <div id="reviewVehicle" class="text-muted"></div>
                                        </div>
                                        <div class="mb-3">
                                            <strong>Specifications:</strong>
                                            <div id="reviewSpecs" class="text-muted"></div>
                                        </div>
                                        <div class="mb-3">
                                            <strong>Features:</strong>
                                            <div id="reviewFeatures" class="text-muted"></div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <strong>Location:</strong>
                                            <div id="reviewLocation" class="text-muted"></div>
                                        </div>
                                        <div class="mb-3">
                                            <strong>Daily Rate:</strong>
                                            <div id="reviewPrice" class="text-success fw-bold fs-5"></div>
                                        </div>
                                        <div class="mb-3">
                                            <strong>Availability:</strong>
                                            <div id="reviewAvailability" class="text-muted"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Terms and Conditions -->
                        <div class="mb-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="carTerms" required>
                                <label class="form-check-label text-muted" for="carTerms">
                                    I confirm that all information provided is accurate and I agree to the 
                                    <a href="#" class="text-primary text-decoration-none">vehicle listing terms</a>. 
                                    I understand that I am responsible for maintaining the vehicle in good condition 
                                    and providing accurate availability information.
                                </label>
                            </div>
                        </div>

                        <!-- Insurance Note -->
                        <div class="alert alert-warning border-0 mb-4">
                            <h6 class="alert-heading mb-2">
                                <i class="fas fa-shield-alt me-2"></i>Insurance Notice
                            </h6>
                            <p class="mb-0 small">
                                Ensure your vehicle is properly insured for commercial rental activities. 
                                Your Car! provides supplemental insurance, but primary coverage remains your responsibility.
                            </p>
                        </div>

                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-outline-primary btn-lg px-5" onclick="prevStep(3)">
                                <i class="fas fa-arrow-left me-2"></i>Back
                            </button>
                            <button type="submit" class="btn btn-success btn-lg px-5" id="submitCarBtn">
                                <i class="fas fa-plus-circle me-2"></i>Add Car to Fleet
                            </button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Tips Section -->
            <div class="row mt-5">
                <div class="col-12">
                    <div class="card bg-primary text-white border-0">
                        <div class="card-body">
                            <h5 class="card-title mb-4">
                                <i class="fas fa-lightbulb me-2"></i>Tips for Success
                            </h5>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-camera me-3 mt-1"></i>
                                        <div>
                                            <h6 class="fw-bold">Quality Photos</h6>
                                            <p class="small mb-0">Clean, well-lit photos attract more renters</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-dollar-sign me-3 mt-1"></i>
                                        <div>
                                            <h6 class="fw-bold">Competitive Pricing</h6>
                                            <p class="small mb-0">Research similar cars in your area</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-star me-3 mt-1"></i>
                                        <div>
                                            <h6 class="fw-bold">Detailed Description</h6>
                                            <p class="small mb-0">Highlight unique features and condition</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
let currentStep = 1;
let uploadedImages = [];

function setQuickLocation(location) {
    document.getElementById('location').value = location;
    validateLocation();
}

function previewImages(files) {
    const previewContainer = document.getElementById('imagePreview');
    previewContainer.innerHTML = '';
    
    if (files.length > 0) {
        document.querySelector('.image-upload-area').innerHTML = `
            <i class="fas fa-check-circle fa-2x text-success mb-2"></i>
            <h6 class="text-success mb-1">${files.length} photo(s) selected</h6>
            <p class="text-muted small mb-0">Click to change photos</p>
        `;
    }
    
    Array.from(files).forEach((file, index) => {
        if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const col = document.createElement('div');
                col.className = 'col-6 col-md-4 col-lg-3';
                col.innerHTML = `
                    <div class="image-preview-card position-relative">
                        <img src="${e.target.result}" class="img-fluid rounded" alt="Preview ${index + 1}">
                        <button type="button" class="btn btn-sm btn-danger position-absolute top-0 end-0 m-1" 
                                onclick="removeImage(${index})">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                previewContainer.appendChild(col);
            };
            reader.readAsDataURL(file);
            uploadedImages.push(file);
        }
    });
}

function removeImage(index) {
    uploadedImages.splice(index, 1);
    previewImages(uploadedImages);
}

function showStep(step) {
    // Hide all steps
    document.querySelectorAll('.form-step').forEach(stepEl => {
        stepEl.classList.remove('active');
    });
    
    // Show current step
    document.getElementById(`step${step}`).classList.add('active');
    
    // Update progress
    document.querySelectorAll('.progress-step').forEach(progressStep => {
        const stepNumber = parseInt(progressStep.getAttribute('data-step'));
        if (stepNumber <= step) {
            progressStep.classList.add('active');
        } else {
            progressStep.classList.remove('active');
        }
    });
    
    currentStep = step;
    
    // Update review if on step 4
    if (step === 4) {
        updateReview();
    }
}

function nextStep(next) {
    if (validateStep(currentStep)) {
        showStep(next);
    }
}

function prevStep(prev) {
    showStep(prev);
}

function validateStep(step) {
    switch(step) {
        case 1:
            const brand = document.getElementById('brand').value;
            const model = document.getElementById('model').value;
            const year = document.getElementById('year').value;
            const price = document.getElementById('price_per_day').value;
            const seats = document.getElementById('seats').value;
            
            if (!brand || !model || !year || !price || !seats) {
                alert('Please fill in all required fields in Basic Information.');
                return false;
            }
            return true;
            
        case 2:
            const transmission = document.getElementById('transmission').value;
            const fuelType = document.getElementById('fuel_type').value;
            
            if (!transmission || !fuelType) {
                alert('Please fill in all required specifications.');
                return false;
            }
            return true;
            
        case 3:
            const location = document.getElementById('location').value;
            if (!location) {
                alert('Please enter the car location.');
                return false;
            }
            return true;
            
        default:
            return true;
    }
}

function updateReview() {
    // Vehicle info
    const brand = document.getElementById('brand').value;
    const model = document.getElementById('model').value;
    const year = document.getElementById('year').value;
    document.getElementById('reviewVehicle').textContent = `${year} ${brand} ${model}`;
    
    // Specifications
    const transmission = document.getElementById('transmission').value;
    const fuelType = document.getElementById('fuel_type').value;
    const seats = document.getElementById('seats').value;
    const condition = document.getElementById('condition').value;
    document.getElementById('reviewSpecs').textContent = 
        `${transmission} • ${fuelType} • ${seats} seats • ${condition.replace('_', ' ')} condition`;
    
    // Features
    const features = [];
    document.querySelectorAll('input[name="features"]:checked').forEach(checkbox => {
        features.push(checkbox.nextElementSibling.textContent.trim());
    });
    document.getElementById('reviewFeatures').textContent = 
        features.length > 0 ? features.join(', ') : 'No additional features selected';
    
    // Location and price
    document.getElementById('reviewLocation').textContent = document.getElementById('location').value;
    document.getElementById('reviewPrice').textContent = `$${document.getElementById('price_per_day').value}/day`;
    
    // Availability
    const available = document.getElementById('available').checked;
    document.getElementById('reviewAvailability').textContent = 
        available ? 'Available immediately' : 'Will be available later';
}

// Validation functions
function validateBrand() {
    const brand = document.getElementById('brand');
    brand.classList.toggle('is-valid', brand.value !== '');
    brand.classList.toggle('is-invalid', brand.value === '');
}

function validateModel() {
    const model = document.getElementById('model');
    const isValid = model.value.length >= 2;
    model.classList.toggle('is-valid', isValid && model.value !== '');
    model.classList.toggle('is-invalid', !isValid && model.value !== '');
}

function validateYear() {
    const year = document.getElementById('year');
    year.classList.toggle('is-valid', year.value !== '');
    year.classList.toggle('is-invalid', year.value === '');
}

function validatePrice() {
    const price = document.getElementById('price_per_day');
    const isValid = price.value >= 1 && price.value <= 1000;
    price.classList.toggle('is-valid', isValid && price.value !== '');
    price.classList.toggle('is-invalid', !isValid && price.value !== '');
}

function validateSeats() {
    const seats = document.getElementById('seats');
    seats.classList.toggle('is-valid', seats.value !== '');
    seats.classList.toggle('is-invalid', seats.value === '');
}

function validateTransmission() {
    const transmission = document.getElementById('transmission');
    transmission.classList.toggle('is-valid', transmission.value !== '');
    transmission.classList.toggle('is-invalid', transmission.value === '');
}

function validateFuelType() {
    const fuelType = document.getElementById('fuel_type');
    fuelType.classList.toggle('is-valid', fuelType.value !== '');
    fuelType.classList.toggle('is-invalid', fuelType.value === '');
}

function validateCondition() {
    const condition = document.getElementById('condition');
    condition.classList.toggle('is-valid', condition.value !== '');
}

function validateLocation() {
    const location = document.getElementById('location');
    const isValid = location.value.length >= 5;
    location.classList.toggle('is-valid', isValid && location.value !== '');
    location.classList.toggle('is-invalid', !isValid && location.value !== '');
}

// Initialize
document.addEventListener('DOMContentLoaded', function() {
    // Add event listeners for real-time validation
    document.getElementById('brand').addEventListener('change', validateBrand);
    document.getElementById('model').addEventListener('input', validateModel);
    document.getElementById('year').addEventListener('change', validateYear);
    document.getElementById('price_per_day').addEventListener('input', validatePrice);
    document.getElementById('seats').addEventListener('change', validateSeats);
    document.getElementById('transmission').addEventListener('change', validateTransmission);
    document.getElementById('fuel_type').addEventListener('change', validateFuelType);
    document.getElementById('condition').addEventListener('change', validateCondition);
    document.getElementById('location').addEventListener('input', validateLocation);
    
    // Form submission
    document.getElementById('addCarForm').addEventListener('submit', function(e) {
        if (!document.getElementById('carTerms').checked) {
            e.preventDefault();
            alert('Please agree to the terms and conditions.');
        }
    });
});
</script>

<style>
.add-car-progress {
    display: flex;
    justify-content: space-between;
    align-items: center;
    max-width: 600px;
    margin: 0 auto;
}

.progress-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    position: relative;
}

.progress-step::before {
    content: '';
    position: absolute;
    top: 20px;
    left: -50%;
    width: 100%;
    height: 3px;
    background: #e9ecef;
    z-index: 1;
}

.progress-step:first-child::before {
    display: none;
}

.progress-step.active::before {
    background: #2563eb;
}

.step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #e9ecef;
    color: #6c757d;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    margin-bottom: 8px;
    position: relative;
    z-index: 2;
}

.progress-step.active .step-number {
    background: #2563eb;
    color: white;
}

.step-label {
    font-size: 0.875rem;
    color: #6c757d;
    font-weight: 500;
}

.progress-step.active .step-label {
    color: #2563eb;
    font-weight: 600;
}

.form-step {
    display: none;
}

.form-step.active {
    display: block;
    animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.form-card {
    background: white;
    border-radius: 20px;
    padding: 40px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    border: none;
}

.image-upload-area {
    cursor: pointer;
    transition: all 0.3s ease;
}

.image-upload-area:hover {
    border-color: #2563eb !important;
    background: #f0f4ff !important;
}

.image-preview-card {
    border-radius: 10px;
    overflow: hidden;
}

.image-preview-card img {
    width: 100%;
    height: 120px;
    object-fit: cover;
}

.form-check-input:checked {
    background-color: #2563eb;
    border-color: #2563eb;
}

.is-valid {
    border-color: #198754 !important;
}

.is-invalid {
    border-color: #dc3545 !important;
}

.input-group-text {
    border-radius: 10px 0 0 10px !important;
}

.form-control {
    border-radius: 0 10px 10px 0 !important;
}
</style>
{% endblock %}